name: Dockerized Android APK Build (Kivy/Buildozer)

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¦ Checkout Repository
      uses: actions/checkout@v4

    - name: ğŸ‹ Execute Buildozer in Kivy Docker Container
      # This single step replaces all complex setup, license acceptance, and build steps.
      # It uses the official Docker image with all dependencies pre-configured and licenses accepted.
      uses: docker://kivy/buildozer:stable
      with:
        # The entrypoint is the buildozer command, run inside the container
        args: android debug

    - name: â¬†ï¸ Upload APK artifact
      uses: actions/upload-artifact@v4
      with:
        name: Classic_Pong_APK
        # The built APK will be in the project's 'bin' directory
        path: ./bin/*.apk
